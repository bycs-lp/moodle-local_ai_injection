define("local_ai_injection/confirm_ai_usage",["exports","local_ai_manager/infobox","local_ai_manager/warningbox","core/modal_save_cancel","core/modal_cancel","core/modal_events","core/templates","core/str","core/localstorage","core/config"],(function(_exports,_infobox,_warningbox,_modal_save_cancel,_modal_cancel,_modal_events,_templates,_str,_localstorage,_config){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * AI usage confirmation modal.
   *
   * Provides functions to show a confirmation modal before AI features are used
   * and an info-only modal to review AI usage hints.
   *
   * @module     local_ai_injection/confirm_ai_usage
   * @copyright  2026 ISB Bayern
   * @author     Thomas SchÃ¶nlein
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.showAiInfo=_exports.isAiUsageConfirmed=_exports.confirmAiUsage=void 0,_modal_save_cancel=_interopRequireDefault(_modal_save_cancel),_modal_cancel=_interopRequireDefault(_modal_cancel),_modal_events=_interopRequireDefault(_modal_events),_templates=_interopRequireDefault(_templates),_localstorage=_interopRequireDefault(_localstorage);const getStorageKey=async()=>(async stringToHash=>{const data=(new TextEncoder).encode(stringToHash),hashAsArrayBuffer=await window.crypto.subtle.digest("SHA-256",data),uint8ViewOfHash=new Uint8Array(hashAsArrayBuffer);return Array.from(uint8ViewOfHash).map((b=>b.toString(16).padStart(2,"0"))).join("")})("local_ai_injection_ai_confirmed_"+_config.userId);_exports.isAiUsageConfirmed=async()=>{const key=await getStorageKey();return"1"===_localstorage.default.get(key)};_exports.confirmAiUsage=async function(component){let purposes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const storageKey=await getStorageKey();if("1"===_localstorage.default.get(storageKey))return!0;const[bodyHtml,title,saveButtonText]=await Promise.all([_templates.default.render("local_ai_injection/confirm_ai_usage_modal",{}),(0,_str.getString)("confirmaiusage_title","local_ai_injection"),(0,_str.getString)("confirmaiusage_confirm","local_ai_injection")]),modal=await _modal_save_cancel.default.create({title:title,body:bodyHtml,large:!0,show:!0,removeOnClose:!0,buttons:{save:saveButtonText}}),container=modal.getBody()[0].querySelector(".local_ai_injection-confirm-content");return await Promise.all([(0,_infobox.renderInfoBox)(component,_config.userId,container,purposes),(0,_warningbox.renderWarningBox)(container)]),new Promise((resolve=>{modal.getRoot().on(_modal_events.default.save,(()=>{_localstorage.default.set(storageKey,"1"),resolve(!0)})),modal.getRoot().on(_modal_events.default.hidden,(()=>{resolve(!1)}))}))};_exports.showAiInfo=async function(component){let purposes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const[bodyHtml,title,closeText]=await Promise.all([_templates.default.render("local_ai_injection/confirm_ai_usage_modal",{}),(0,_str.getString)("info_aiusage","local_ai_injection"),(0,_str.getString)("close","local_ai_injection")]),modal=await _modal_cancel.default.create({title:title,body:bodyHtml,large:!0,show:!0,removeOnClose:!0,buttons:{cancel:closeText}}),container=modal.getBody()[0].querySelector(".local_ai_injection-confirm-content");await Promise.all([(0,_infobox.renderInfoBox)(component,_config.userId,container,purposes),(0,_warningbox.renderWarningBox)(container)])}}));

//# sourceMappingURL=confirm_ai_usage.min.js.map