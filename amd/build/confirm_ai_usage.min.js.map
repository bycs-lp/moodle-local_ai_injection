{"version":3,"file":"confirm_ai_usage.min.js","sources":["../src/confirm_ai_usage.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *\n * @module     local_ai_injection/confirm_ai_usage\n * @copyright  2026 ISB Bayern\n * @author     Thomas Sch√∂nlein\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport {renderInfoBox} from 'local_ai_manager/infobox';\nimport {renderWarningBox} from 'local_ai_manager/warningbox';\nimport Modal from 'core/modal';\nimport ModalEvents from 'core/modal_events';\nimport {userId} from 'core/config';\n\nexport const SESSION_KEY = 'local_ai_injection_ai_confirmed';\n\n\nclass ConfirmModal extends Modal {\n     static TYPE = 'local_ai_injection/confirm_ai_usage_modal';\n     static TEMPLATE = 'local_ai_injection/confirm_ai_usage_modal';\n\n    configure(modalConfig) {\n        modalConfig.removeOnClose = true;\n        this.registerCloseOnCancel();\n        this.registerCloseOnSave();\n        super.configure(modalConfig);\n    }\n}\n\n\n/**\n *\n * @param {string} component the component from which the request is being done\n * @param {array} purposes the purpose to use for the request\n * @returns {Promise<boolean>}\n */\n\nexport const confirmAiUsage = async(component, purposes = []) => {\n\n    if (sessionStorage.getItem(SESSION_KEY) === '1') {\n        return true;\n    }\n\n    const modal = await ConfirmModal.create({show: true, templateContext: {infoonly: false}});\n    const container = modal.getBody()[0].querySelector('.local_ai_injection-confirm-content');\n\n    await renderInfoBox(component, userId, container, purposes);\n    await renderWarningBox(container);\n\n    return new Promise(resolve => {\n        modal.getRoot().on(ModalEvents.save, () => {\n            sessionStorage.setItem(SESSION_KEY, '1');\n            resolve(true);\n            modal.destroy();\n        });\n        modal.getRoot().on(ModalEvents.hidden, () => {\n            resolve(false);\n        });\n    });\n\n};\n\n/**\n *\n * @param {string} component the component from which the request is being done\n * @param {array} purposes the purpose to use for the request\n */\nexport const showAiInfo = async(component, purposes = []) => {\n    const modal = await ConfirmModal.create({show: true, templateContext: {infoonly: true}});\n    const container = modal.getBody()[0].querySelector('.local_ai_injection-confirm-content');\n\n    await renderInfoBox(component, userId, container, purposes);\n    await renderWarningBox(container);\n};\n"],"names":["SESSION_KEY","ConfirmModal","Modal","configure","modalConfig","removeOnClose","registerCloseOnCancel","registerCloseOnSave","async","component","purposes","sessionStorage","getItem","modal","create","show","templateContext","infoonly","container","getBody","querySelector","userId","Promise","resolve","getRoot","on","ModalEvents","save","setItem","destroy","hidden"],"mappings":"6rBA4BaA,YAAc,yEAGrBC,qBAAqBC,eAIvBC,UAAUC,aACNA,YAAYC,eAAgB,OACvBC,6BACAC,4BACCJ,UAAUC,8BARlBH,oBACa,6DADbA,wBAEiB,qEAkBOO,eAAMC,eAAWC,gEAAW,MAEV,MAAxCC,eAAeC,QAAQZ,oBAChB,QAGLa,YAAcZ,aAAaa,OAAO,CAACC,MAAM,EAAMC,gBAAiB,CAACC,UAAU,KAC3EC,UAAYL,MAAMM,UAAU,GAAGC,cAAc,oDAE7C,0BAAcX,UAAWY,eAAQH,UAAWR,gBAC5C,gCAAiBQ,WAEhB,IAAII,SAAQC,UACfV,MAAMW,UAAUC,GAAGC,sBAAYC,MAAM,KACjChB,eAAeiB,QAAQ5B,YAAa,KACpCuB,SAAQ,GACRV,MAAMgB,aAEVhB,MAAMW,UAAUC,GAAGC,sBAAYI,QAAQ,KACnCP,SAAQ,8BAWMf,eAAMC,eAAWC,gEAAW,SAC5CG,YAAcZ,aAAaa,OAAO,CAACC,MAAM,EAAMC,gBAAiB,CAACC,UAAU,KAC3EC,UAAYL,MAAMM,UAAU,GAAGC,cAAc,6CAE7C,0BAAcX,UAAWY,eAAQH,UAAWR,gBAC5C,gCAAiBQ"}